/*
Basic YARA rules for malware detection
*/

rule suspicious_strings {
    meta:
        description = "Detect suspicious strings commonly found in malware"
        severity = "medium"
    
    strings:
        $sus1 = "CreateRemoteThread" wide ascii
        $sus2 = "VirtualAlloc" wide ascii
        $sus3 = "WriteProcessMemory" wide ascii
        $sus4 = "RunDll32" wide ascii
        $sus5 = "cmd.exe /c" wide ascii
        $sus6 = "powershell -enc" wide ascii
        
    condition:
        2 of them
}

rule suspicious_file_characteristics {
    meta:
        description = "Detect suspicious file characteristics"
        severity = "medium"
    
    strings:
        $packed = "UPX" wide ascii
        $shellcode = {55 8B EC} // Common x86 shellcode pattern
        
    condition:
        any of them
}

rule potential_ransomware {
    meta:
        description = "Detect potential ransomware characteristics"
        severity = "high"
    
    strings:
        $ransom1 = "Your files have been encrypted" wide ascii
        $ransom2 = "bitcoin" wide ascii nocase
        $ransom3 = "decrypt" wide ascii nocase
        $ext1 = ".encrypted" wide ascii
        $ext2 = ".locked" wide ascii
        
    condition:
        2 of them
}